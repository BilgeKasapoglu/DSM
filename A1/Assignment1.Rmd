---
title:  |
  <center> DATA SCIENCE METHODS </center>
  <center> Assignment 01 </center>
author: "Bilge KasapoÄŸlu | Hoan Van Nguyen | Jiahe Wang | Roshini Sudhaharan"
date: "07/03/2022"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Load the necessary packages
if (!require("pacman")) install.packages("pacman")
pacman::p_load(knitr,
               tibble,
               tidyverse,
               smacof,
               data.table,
               softImpute,
               PMA,
               missMDA,
               stargazer,
               cluster,
               NbClust,
               tidyverse,
               data.table,
               dplyr,
               mFilter)
```

# QUESTION 01
```{r}
#create matrix with n = 6 observations and p = 2 features; 
#third column indicating cluster: 1 is cluster A, 2 is cluster B
set.seed(1)
m = cbind(x1 = c(4, 1, 0, 2, 6, 4), x2 = c(1, 3, 4, 1, 2, 0), clusters = c(2,1,1,2,1,2))
m
```

## a.
![](https://user-images.githubusercontent.com/90349323/157056103-aea2b5b1-c12e-4d81-8854-fc05f585de7d.jpeg)
```{r}
#plot x1 against x2

plot(m[,1], m[,2], col = ifelse(m[,3] == 1, "blue", "red"))
legend(3,4,legend = c("Cluster A", "Cluster B"), col = c("Blue", "Red"), pch = 1)
```

## b.
```{r}
#calculate centroids for two clusters A & B and plot them

centroidA = c(mean(m[m[,3]==1, 1]), mean(m[m[,3]==1, 2]))
centroidB = c(mean(m[m[,3]==2, 1]), mean(m[m[,3]==2, 2]))
print(centroidA)
print(centroidB)

plot(m[,1], m[,2], col = ifelse(m[,3] == 1, "blue", "red"))
legend(3,4,legend = c("Cluster A", "Cluster B"), col = c("Blue", "Red"), pch = 1)
points(x = centroidA[1], y = centroidA[2], col = "blue", pch = 16, cex = 2)
points(x = centroidB[1], y = centroidB[2], col = "red", pch = 16, cex = 2)
```

## c.
![](https://user-images.githubusercontent.com/90349323/157064576-e63814ed-be63-4978-982b-d188e3d098de.jpeg)

```{r}
#assign each observations to the centroid 
#to which it is the closest in terms of Euclidean distance

euclidean = function(a, b) {
  return(sqrt((a[1] - b[1])^2 + (a[2]-b[2])^2))
}
assign_clusters = function(m, centroidA, centroidB) {
  new_clusters = rep(NA, nrow(m))
  for (i in 1:nrow(m)) {
    if (euclidean(m[i,], centroidA) < euclidean(m[i,], centroidB)) {
      new_clusters[i] = 1
    } else {
      new_clusters[i] = 2
    }
  }
  return(new_clusters)
}
new_clusters = assign_clusters(m, centroidA, centroidB)
new_clusters
```

```{r}
#new matrix including new cluster membership

m1 <- cbind(m, new_clusters)
m1
```

```{r}
#new plot showing new cluster membership

plot(m1[,1], m1[,2], col = ifelse(m1[,4] == 1, "blue", "red"))
legend(3,4,legend = c("Cluster A", "Cluster B"), col = c("Blue", "Red"), pch = 1)
```

## d.
```{r}
#repeat 1c until the answer stops changing

last_clusters = rep(-1, 6)
while (!all(last_clusters == new_clusters)) {
  last_clusters = new_clusters
  centroidA = c(mean(m1[m1[,4] == 1, 1]), mean(m1[m1[,4] == 1, 2]))
  centroidB = c(mean(m1[m1[,4] == 2, 1]), mean(m1[m1[,4] == 2, 2]))
  print(centroidA)
  print(centroidB)
  new_clusters = assign_clusters(m1, centroidA, centroidB)
}
new_clusters
```
## According to the results above, we can conclude that observations 2 and 3 belong to one cluster, and other observations 1, 4, 5, and 6 belong to another cluster. 

# QUESTION 02

```{r}

```

# QUESTION 03
